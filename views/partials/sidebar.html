<div class="sidebar-content">
    <!-- User Info (mobile only) -->
    <div class="d-md-none mb-4 pb-3 border-bottom">
        <div class="d-flex align-items-center">
            <div class="bg-primary bg-opacity-10 rounded-circle p-3 me-3">
                <i class="bi bi-person-circle fs-3 text-primary"></i>
            </div>
            <div>
                <h6 class="mb-1">
                    <%= user?.name || user?.username %>
                </h6>
                <small class="text-muted">
                    <%= user?.email || 'No email' %>
                </small>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <ul class="nav nav-pills flex-column mb-4">
        <li class="nav-item">
            <a href="/" class="nav-link <%= title === 'Dashboard' ? 'active' : '' %>">
                <i class="bi bi-speedometer2"></i>
                <span>Dashboard</span>
            </a>
        </li>

        <!-- Communication Section -->
        <li class="nav-item mt-3">
            <small class="text-muted text-uppercase fw-bold px-2">Communication</small>
        </li>
        <li class="nav-item">
            <a href="/sms"
                class="nav-link d-flex justify-content-between align-items-center <%= title === 'SMS Management' ? 'active' : '' %>">
                <span>
                    <i class="bi bi-chat-dots"></i>
                    <span>SMS</span>
                </span>
                <span class="badge bg-danger rounded-pill" id="unreadSmsBadge" style="display: none;">0</span>
            </a>
        </li>
        <li class="nav-item">
            <a href="/calls" class="nav-link <%= title === 'Call Management' ? 'active' : '' %>">
                <i class="bi bi-telephone"></i>
                <span>Calls</span>
            </a>
        </li>
        <li class="nav-item">
            <a href="/contacts" class="nav-link <%= title === 'Contact Management' ? 'active' : '' %>">
                <i class="bi bi-person-lines-fill"></i>
                <span>Contacts</span>
            </a>
        </li>
        <li class="nav-item">
            <a href="/ussd" class="nav-link <%= title === 'USSD Services' ? 'active' : '' %>">
                <i class="bi bi-telephone-forward"></i>
                <span>USSD</span>
            </a>
        </li>

        <!-- Device Section -->
        <li class="nav-item mt-3">
            <small class="text-muted text-uppercase fw-bold px-2">Device</small>
        </li>
        <li class="nav-item">
            <a href="/modem" class="nav-link <%= title === 'Modem Control' ? 'active' : '' %>">
                <i class="bi bi-wifi"></i>
                <span>Modem</span>
            </a>
        </li>
        <li class="nav-item">
            <a href="/webcam" class="nav-link <%= title === 'Webcam' ? 'active' : '' %>">
                <i class="bi bi-camera"></i>
                <span>Webcam</span>
            </a>
        </li>
        <li class="nav-item">
            <a href="#" class="nav-link disabled opacity-50">
                <i class="bi bi-hdd-stack"></i>
                <span>File Browser</span>
            </a>
        </li>
        <li class="nav-item">
            <a href="#" class="nav-link disabled opacity-50">
                <i class="bi bi-geo-alt"></i>
                <span>GPS</span>
            </a>
        </li>
        <li class="nav-item">
            <a href="#" class="nav-link disabled opacity-50">
                <i class="bi bi-motherboard"></i>
                <span>GPIO</span>
            </a>
        </li>

        <!-- System Section -->
        <li class="nav-item mt-3">
            <small class="text-muted text-uppercase fw-bold px-2">System</small>
        </li>
        <li class="nav-item">
            <a href="/settings" class="nav-link <%= title === 'Settings' ? 'active' : '' %>">
                <i class="bi bi-gear"></i>
                <span>Settings</span>
            </a>
        </li>
    </ul>

    <!-- Enhanced Compact Device Status -->
    <div class="mt-auto pt-2 border-top">
        <!-- Main Status Bar -->
        <div class="d-flex align-items-center justify-content-between mb-2">
            <div class="d-flex align-items-center">
                <span class="status-indicator me-2">
                    <span class="spinner-grow spinner-grow-sm text-success" id="sidebarOnlineIndicator" style="width: 0.6rem; height: 0.6rem; display: none;"></span>
                    <span class="spinner-grow spinner-grow-sm text-secondary" id="sidebarOfflineIndicator" style="width: 0.6rem; height: 0.6rem;"></span>
                </span>
                <small class="fw-medium" id="sidebarStatusText">Offline</small>
            </div>
            <small class="text-muted" id="sidebarUptime">0d 0h</small>
        </div>

        <!-- Compact Metrics Row -->
        <div class="row g-1 mb-1">
            <div class="col-6">
                <div class="d-flex align-items-center">
                    <i class="bi bi-wifi me-1 small"></i>
                    <small class="text-muted me-1">Signal:</small>
                    <small class="fw-bold" id="sidebarSignal">--%</small>
                </div>
            </div>
            <div class="col-6">
                <div class="d-flex align-items-center">
                    <i class="bi bi-battery-full me-1 small"></i>
                    <small class="text-muted me-1">Battery:</small>
                    <small class="fw-bold" id="sidebarBattery">--%</small>
                    <small class="text-success ms-1" id="sidebarCharging" style="display: none;">
                        <i class="bi bi-lightning-charge-fill" style="font-size: 0.7rem;"></i>
                    </small>
                </div>
            </div>
        </div>

        <!-- Network Info -->
        <div class="d-flex align-items-center justify-content-between small">
            <div class="d-flex align-items-center">
                <i class="bi bi-broadcast me-1"></i>
                <small class="text-muted me-1">Network:</small>
                <small class="fw-bold" id="sidebarNetwork">---</small>
            </div>
            <small class="text-muted" id="sidebarOperator">---</small>
        </div>

        <!-- Tiny Progress Bar for Signal (optional) -->
        <div class="progress mt-2" style="height: 2px;">
            <div class="progress-bar" id="sidebarSignalBar" role="progressbar" style="width: 0%"></div>
        </div>
    </div>
</div>

<style>
    /* Sidebar styles */
    .sidebar-content {
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .nav-pills .nav-link {
        border-radius: 0.5rem;
        padding: 0.75rem 1rem;
        margin-bottom: 0.25rem;
        color: #495057;
        min-height: 48px;
    }

    .nav-pills .nav-link i {
        width: 1.8rem;
        font-size: 1.2rem;
    }

    .nav-pills .nav-link.active {
        background-color: #e9ecef;
        color: #0d6efd;
        font-weight: 500;
    }

    .nav-pills .nav-link.disabled {
        color: #adb5bd;
        pointer-events: none;
    }

    /* Status indicator animation */
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }

    .status-indicator .spinner-grow {
        animation: pulse 2s infinite;
    }

    /* Compact status bar */
    .status-indicator .spinner-grow {
        width: 0.6rem;
        height: 0.6rem;
    }

    .small {
        font-size: 0.75rem;
    }

    .row.g-1 {
        margin: -0.25rem;
    }
    
    .row.g-1 > [class*="col-"] {
        padding: 0.25rem;
    }

    /* Mobile adjustments */
    @media (max-width: 767.98px) {
        .nav-pills .nav-link {
            padding: 1rem;
        }

        .nav-pills .nav-link i {
            width: 2rem;
            font-size: 1.3rem;
        }
    }
</style>